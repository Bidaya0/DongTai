{"type":36,"version":"v3","detail":{"agentId":374,"protocol":"HTTP/1.1","scheme":"http","method":"GET","secure":false,"url":"http://localhost:8001/api/cmd-injection/unsafe/runtime-exec","uri":"/api/cmd-injection/unsafe/runtime-exec","clientIp":"127.0.0.1","queryString":"cmd=whoami","reqHeader":"c2VjLWZldGNoLW1vZGU6Y29ycwpyZWZlcmVyOmh0dHA6Ly9sb2NhbGhvc3Q6ODAwMS9zd2FnZ2VyLXVpL2luZGV4Lmh0bWwKc2VjLWZldGNoLXNpdGU6c2FtZS1vcmlnaW4KYWNjZXB0LWxhbmd1YWdlOnpoLUNOLHpoO3E9MC45CmNvb2tpZTphanNfdXNlcl9pZD1lYTQ2ZGUxYS01NjNhLTVhODAtOTVhZi02MjkxMDljMjk1ZmY7IGFqc19hbm9ueW1vdXNfaWQ9MDYwOWIzMWItNmU0MS00MjQxLTg3YjItZGE1NDRjMDg1ZDM1OyByZW1lbWJlci1tZT1ZV1J0YVc0Nk1UWTVNVE0zT0RZNE56UXlOam8zTlRVMk9XRm1ZMkZrTWpFelpUaGxNVE0wTmpReU16RXhPR1V6TnpSa05RCmR0LXRyYWNlaWQ6MjlhNTNiMzg3OWI4NGIwZWEwZjZjYTQzMWRjMjEwZmEuMC4wLjZhMzA1ZTRiMjcyZDM2Y2YKYWNjZXB0OmFwcGxpY2F0aW9uL2pzb24Kc2VjLWNoLXVhOiJOb3QvQSlCcmFuZCI7dj0iOTkiLCAiR29vZ2xlIENocm9tZSI7dj0iMTE1IiwgIkNocm9taXVtIjt2PSIxMTUiCnNlYy1jaC11YS1tb2JpbGU6PzAKc2VjLWNoLXVhLXBsYXRmb3JtOiJtYWNPUyIKaG9zdDpsb2NhbGhvc3Q6ODAwMQpjb25uZWN0aW9uOmtlZXAtYWxpdmUKYWNjZXB0LWVuY29kaW5nOmd6aXAsIGRlZmxhdGUsIGJyCnVzZXItYWdlbnQ6TW96aWxsYS81LjAgKE1hY2ludG9zaDsgSW50ZWwgTWFjIE9TIFggMTBfMTVfNykgQXBwbGVXZWJLaXQvNTM3LjM2IChLSFRNTCwgbGlrZSBHZWNrbykgQ2hyb21lLzExNS4wLjAuMCBTYWZhcmkvNTM3LjM2CnNlYy1mZXRjaC1kZXN0OmVtcHR5Cg==","reqBody":"","resHeader":"SFRUUC8xLjEgMjAwCktlZXAtQWxpdmU6dGltZW91dD02MApDb25uZWN0aW9uOmtlZXAtYWxpdmUKRGF0ZTpNb24sIDA3IEF1ZyAyMDIzIDAzOjE0OjI4IEdNVApEb25nVGFpOnYxLjEyLjAKQ29udGVudC1MZW5ndGg6MTEwCkNvbnRlbnQtVHlwZTphcHBsaWNhdGlvbi9qc29uCg==","resBody":"eyJjb2RlIjowLCJlbnRyeXBvaW50IjoiR0VUIC9hcGkvY21kLWluamVjdGlvbi91bnNhZmUvcnVu\ndGltZS1leGVjIiwiY29udGVudCI6InNoOiBhYm1pOiBjb21tYW5kIG5vdCBmb3VuZFxuIn0=","contextPath":"","replayRequest":false,"pool":[{"invokeId":29,"source":true,"originClassName":"org.apache.catalina.connector.RequestFacade","className":"javax.servlet.http.HttpServletRequest","methodName":"getHeaders","signature":"javax.servlet.http.HttpServletRequest.getHeaders(java.lang.String)","callerClass":"org.springframework.web.context.request.ServletWebRequest","callerMethod":"getHeaderValues","callerLineNumber":135,"sourceHash":[],"targetHash":[354206851],"taintPosition":{"source":["P1"],"target":["R"]},"objValue":"[org.apache.catalina.connector.RequestFacade@729b21ae]52","parameterValues":[{"index":"P1","value":"[Accept]*6"}],"retValue":"[org.apache.tomcat.util.http.ValuesEnumerator@151cc483]*53","targetRange":[{"hash":354206851,"ranges":[{"name":"untrusted","start":0,"stop":53},{"name":"cross-site","start":0,"stop":53}]}]},{"invokeId":30,"source":false,"originClassName":"org.apache.tomcat.util.http.ValuesEnumerator","className":"java.util.Enumeration","methodName":"nextElement","signature":"java.util.Enumeration.nextElement()","callerClass":"java.util.Collections","callerMethod":"list","callerLineNumber":5294,"sourceHash":[354206851],"targetHash":[-188295457624615244],"taintPosition":{"source":["O"],"target":["R"]},"objValue":"[org.apache.tomcat.util.http.ValuesEnumerator@151cc483]*53","retValue":"[application/json]*16","targetRange":[{"hash":-188295457624615244,"ranges":[{"name":"untrusted","start":0,"stop":16},{"name":"cross-site","start":0,"stop":16}]}]},{"invokeId":31,"source":false,"originClassName":"java.lang.String","className":"java.lang.String","methodName":"substring","signature":"java.lang.String.substring(int)","callerClass":"org.springframework.util.MimeTypeUtils","callerMethod":"tokenize","callerLineNumber":319,"sourceHash":[-188295457624615244],"targetHash":[-188295457624615244],"taintPosition":{"source":["O"],"target":["R"]},"objValue":"[application/json]*16","retValue":"[application/json]*16","targetRange":[{"hash":-188295457624615244,"ranges":[{"name":"untrusted","start":0,"stop":16},{"name":"cross-site","start":0,"stop":16}]}]},{"invokeId":32,"source":true,"originClassName":"org.apache.catalina.connector.RequestFacade","className":"javax.servlet.http.HttpServletRequest","methodName":"getParameterValues","signature":"javax.servlet.http.HttpServletRequest.getParameterValues(java.lang.String)","callerClass":"org.springframework.web.context.request.ServletWebRequest","callerMethod":"getParameterValues","callerLineNumber":153,"sourceHash":[],"targetHash":[-3387220121123944168],"taintPosition":{"source":["P1"],"target":["R"]},"objValue":"[org.apache.catalina.connector.RequestFacade@729b21ae]52","parameterValues":[{"index":"P1","value":"[cmd]*3"}],"retValue":"[whoami ]*7","targetRange":[{"hash":-3387220121123944168,"ranges":[{"name":"untrusted","start":0,"stop":6},{"name":"cross-site","start":0,"stop":6}]}]},{"invokeId":33,"source":false,"originClassName":"java.lang.StringBuilder","className":"java.lang.StringBuilder","methodName":"<init>","signature":"java.lang.StringBuilder.<init>(java.lang.String)","callerClass":"app.iast.service.http.vul.controller.CmdInjectionController","callerMethod":"unsafeRuntimeExec","callerLineNumber":25,"sourceHash":[-3387220121123944168],"targetHash":[468228728],"taintPosition":{"source":["P1"],"target":["O"]},"objValue":"[whoami]*6","parameterValues":[{"index":"P1","value":"[whoami]*6"}],"targetRange":[{"hash":468228728,"ranges":[{"name":"untrusted","start":0,"stop":6},{"name":"cross-site","start":0,"stop":6}]}]},{"invokeId":34,"source":false,"originClassName":"java.lang.StringBuilder","className":"java.lang.StringBuilder","methodName":"delete","signature":"java.lang.StringBuilder.delete(int,int)","callerClass":"app.iast.service.http.vul.controller.CmdInjectionController","callerMethod":"unsafeRuntimeExec","callerLineNumber":26,"sourceHash":[468228728],"targetHash":[468228728],"taintPosition":{"source":["O"],"target":["O"]},"objValue":"[oami]*4","targetRange":[{"hash":468228728,"ranges":[{"name":"untrusted","start":0,"stop":4},{"name":"cross-site","start":0,"stop":4}]}]},{"invokeId":35,"source":false,"originClassName":"java.lang.StringBuilder","className":"java.lang.StringBuilder","methodName":"replace","signature":"java.lang.StringBuilder.replace(int,int,java.lang.String)","callerClass":"app.iast.service.http.vul.controller.CmdInjectionController","callerMethod":"unsafeRuntimeExec","callerLineNumber":27,"sourceHash":[468228728],"targetHash":[468228728],"taintPosition":{"source":["P3","O"],"target":["O"]},"objValue":"[abmi]*4","parameterValues":[{"index":"P3","value":"[ab]2"}],"targetRange":[{"hash":468228728,"ranges":[{"name":"untrusted","start":2,"stop":4},{"name":"cross-site","start":2,"stop":4}]}]},{"invokeId":36,"source":false,"originClassName":"java.lang.StringBuilder","className":"java.lang.StringBuilder","methodName":"toString","signature":"java.lang.StringBuilder.toString()","callerClass":"app.iast.service.http.vul.controller.CmdInjectionController","callerMethod":"unsafeRuntimeExec","callerLineNumber":30,"sourceHash":[468228728],"targetHash":[12830738280112201],"taintPosition":{"source":["O"],"target":["R"]},"objValue":"[abmi]*4","retValue":"[abmi]*4","targetRange":[{"hash":12830738280112201,"ranges":[{"name":"untrusted","start":2,"stop":4},{"name":"cross-site","start":2,"stop":4}]}]},{"invokeId":37,"source":false,"originClassName":"java.lang.String","className":"java.lang.String","methodName":"getChars","signature":"java.lang.String.getChars(int,int,char[],int)","callerClass":"java.io.BufferedWriter","callerMethod":"write","callerLineNumber":226,"sourceHash":[12830738280112201],"targetHash":[410833142],"taintPosition":{"source":["O"],"target":["P3"]},"objValue":"[abmi]*4","parameterValues":[{"index":"P3","value":"[[C@187cd0f6]*11"}],"targetRange":[{"hash":410833142,"ranges":[{"name":"untrusted","start":2,"stop":4},{"name":"cross-site","start":2,"stop":4}]}]},{"invokeId":38,"source":false,"originClassName":"java.lang.StringBuilder","className":"java.lang.StringBuilder","methodName":"append","signature":"java.lang.StringBuilder.append(java.lang.String)","callerClass":"app.iast.common.vul.CmdInjection","callerMethod":"runtimeExec","callerLineNumber":13,"sourceHash":[12830738280112201],"targetHash":[291766828],"taintPosition":{"source":["P1"],"target":["O"]},"objValue":"[sh -c abmi]*10","parameterValues":[{"index":"P1","value":"[abmi]*4"}],"targetRange":[{"hash":291766828,"ranges":[{"name":"untrusted","start":8,"stop":10},{"name":"cross-site","start":8,"stop":10}]}]},{"invokeId":39,"source":false,"originClassName":"java.lang.StringBuilder","className":"java.lang.StringBuilder","methodName":"toString","signature":"java.lang.StringBuilder.toString()","callerClass":"app.iast.common.vul.CmdInjection","callerMethod":"runtimeExec","callerLineNumber":13,"sourceHash":[291766828],"targetHash":[-1420539627152421837],"taintPosition":{"source":["O"],"target":["R"]},"objValue":"[sh -c abmi]*10","retValue":"[sh -c abmi]*10","targetRange":[{"hash":-1420539627152421837,"ranges":[{"name":"untrusted","start":8,"stop":10},{"name":"cross-site","start":8,"stop":10}]}]},{"invokeId":40,"source":false,"originClassName":"java.lang.Runtime","className":"java.lang.Runtime","methodName":"exec","signature":"java.lang.Runtime.exec(java.lang.String)","callerClass":"app.iast.common.vul.CmdInjection","callerMethod":"runtimeExec","callerLineNumber":18,"sourceHash":[-1420539627152421837],"targetHash":[],"taintPosition":{"source":["P1"]},"objValue":"[java.lang.Runtime@38334f63]26","parameterValues":[{"index":"P1","value":"[sh -c abmi]*10"}],"stacks":["java.lang.Runtime.exec(Runtime.java)","app.iast.common.vul.CmdInjection.runtimeExec(CmdInjection.java:18)","app.iast.service.http.vul.controller.CmdInjectionController.unsafeRuntimeExec(CmdInjectionController.java:30)","sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)","sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)","sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)","java.lang.reflect.Method.invoke(Method.java:498)","org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:190)","org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:138)","org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:105)","org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:878)","org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:792)","org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)","org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1040)","org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:943)","org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)","org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:898)","javax.servlet.http.HttpServlet.service(HttpServlet.java:626)","org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)","javax.servlet.http.HttpServlet.service(HttpServlet.java:733)","org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:227)","org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)","org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:53)","org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)","org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)","org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)","org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)","org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)","org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)","org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)","org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)","org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)","org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)","org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)","org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)","org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)","org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)","org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:202)","org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:97)","org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:542)","org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:143)","org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:92)","org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:78)","org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:346)","org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:374)","org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:65)","org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:887)","org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1684)","org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49)","java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)","java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)","org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)","java.lang.Thread.run(Thread.java:748)"]},{"invokeId":41,"source":false,"originClassName":"java.lang.String","className":"java.lang.String","methodName":"substring","signature":"java.lang.String.substring(int,int)","callerClass":"java.util.StringTokenizer","callerMethod":"nextToken","callerLineNumber":352,"sourceHash":[-1420539627152421837],"targetHash":[15760091826003],"taintPosition":{"source":["O"],"target":["R"]},"objValue":"[sh -c abmi]*10","retValue":"[sh]*2","targetRange":[{"hash":15760091826003,"ranges":[]}]},{"invokeId":42,"source":false,"originClassName":"java.lang.String","className":"java.lang.String","methodName":"substring","signature":"java.lang.String.substring(int,int)","callerClass":"java.util.StringTokenizer","callerMethod":"nextToken","callerLineNumber":352,"sourceHash":[-1420539627152421837],"targetHash":[6418281844168],"taintPosition":{"source":["O"],"target":["R"]},"objValue":"[sh -c abmi]*10","retValue":"[-c]*2","targetRange":[{"hash":6418281844168,"ranges":[]}]},{"invokeId":43,"source":false,"originClassName":"java.lang.String","className":"java.lang.String","methodName":"substring","signature":"java.lang.String.substring(int,int)","callerClass":"java.util.StringTokenizer","callerMethod":"nextToken","callerLineNumber":352,"sourceHash":[-1420539627152421837],"targetHash":[12830738849187138],"taintPosition":{"source":["O"],"target":["R"]},"objValue":"[sh -c abmi]*10","retValue":"[abmi]*4","targetRange":[{"hash":12830738849187138,"ranges":[{"name":"untrusted","start":2,"stop":4},{"name":"cross-site","start":2,"stop":4}]}]},{"invokeId":44,"source":false,"originClassName":"java.lang.String","className":"java.lang.String","methodName":"getBytes","signature":"java.lang.String.getBytes()","callerClass":"java.lang.ProcessImpl","callerMethod":"start","callerLineNumber":74,"sourceHash":[6418281844168],"targetHash":[228974495],"taintPosition":{"source":["O"],"target":["R"]},"objValue":"[-c]*2","retValue":"[[B@da5df9f]*10","targetRange":[{"hash":228974495,"ranges":[]}]},{"invokeId":45,"source":false,"originClassName":"java.lang.String","className":"java.lang.String","methodName":"getBytes","signature":"java.lang.String.getBytes()","callerClass":"java.lang.ProcessImpl","callerMethod":"start","callerLineNumber":74,"sourceHash":[12830738849187138],"targetHash":[96143143],"taintPosition":{"source":["O"],"target":["R"]},"objValue":"[abmi]*4","retValue":"[[B@5bb0727]*10","targetRange":[{"hash":96143143,"ranges":[{"name":"untrusted","start":2,"stop":4},{"name":"cross-site","start":2,"stop":4}]}]},{"invokeId":46,"source":false,"originClassName":"java.lang.String","className":"java.lang.String","methodName":"getBytes","signature":"java.lang.String.getBytes()","callerClass":"java.lang.ProcessImpl","callerMethod":"toCString","callerLineNumber":50,"sourceHash":[15760091826003],"targetHash":[1038136431],"taintPosition":{"source":["O"],"target":["R"]},"objValue":"[sh]*2","retValue":"[[B@3de0b46f]*11","targetRange":[{"hash":1038136431,"ranges":[]}]},{"invokeId":47,"source":true,"originClassName":"org.apache.catalina.connector.RequestFacade","className":"javax.servlet.http.HttpServletRequest","methodName":"getHeaders","signature":"javax.servlet.http.HttpServletRequest.getHeaders(java.lang.String)","callerClass":"org.springframework.web.context.request.ServletWebRequest","callerMethod":"getHeaderValues","callerLineNumber":135,"sourceHash":[],"targetHash":[998916800],"taintPosition":{"source":["P1"],"target":["R"]},"objValue":"[org.apache.catalina.connector.RequestFacade@729b21ae]52","parameterValues":[{"index":"P1","value":"[Accept]*6"}],"retValue":"[org.apache.tomcat.util.http.ValuesEnumerator@3b8a42c0]*53","targetRange":[{"hash":998916800,"ranges":[{"name":"untrusted","start":0,"stop":53},{"name":"cross-site","start":0,"stop":53}]}]},{"invokeId":48,"source":false,"originClassName":"org.apache.tomcat.util.http.ValuesEnumerator","className":"java.util.Enumeration","methodName":"nextElement","signature":"java.util.Enumeration.nextElement()","callerClass":"java.util.Collections","callerMethod":"list","callerLineNumber":5294,"sourceHash":[998916800],"targetHash":[-188295457624615244],"taintPosition":{"source":["O"],"target":["R"]},"objValue":"[org.apache.tomcat.util.http.ValuesEnumerator@3b8a42c0]*53","retValue":"[application/json]*16","targetRange":[{"hash":-188295457624615244,"ranges":[{"name":"untrusted","start":0,"stop":16},{"name":"cross-site","start":0,"stop":16}]}]},{"invokeId":49,"source":false,"originClassName":"java.lang.String","className":"java.lang.String","methodName":"substring","signature":"java.lang.String.substring(int)","callerClass":"org.springframework.util.MimeTypeUtils","callerMethod":"tokenize","callerLineNumber":319,"sourceHash":[-188295457624615244],"targetHash":[-188295457624615244],"taintPosition":{"source":["O"],"target":["R"]},"objValue":"[application/json]*16","retValue":"[application/json]*16","targetRange":[{"hash":-188295457624615244,"ranges":[{"name":"untrusted","start":0,"stop":16},{"name":"cross-site","start":0,"stop":16}]}]}],"traceId":"29a53b3879b84b0ea0f6ca431dc210fa.0.0.6a305e4b272d36cf"}}